# ç–²æƒ«æé†’æµ®çƒ - å¿«é€Ÿå‚è€ƒ

## ğŸ“‹ æ¨¡å—è½¬æ¢æ€»ç»“

`float_ball.py` å·²ä»åŸºç¡€å¤ªæçƒç»„ä»¶æ”¹é€ ä¸ºå®Œæ•´çš„ **ç–²æƒ«æé†’æµ®çƒæ¨¡å—**ã€‚

| æ–¹é¢ | å˜åŒ– |
|------|------|
| ç±»å | `TaijiBall` â†’ `FatigueReminderBall` (ä¿ç•™åˆ«å) |
| åŠŸèƒ½ | è§†è§‰ç»„ä»¶ + å·¥ä½œæ—¶é—´è¿½è¸ª + ç–²æƒ«æé†’ |
| ä¿¡å· | æ–°å¢ `fatigue_reminder_triggered` ä¿¡å· |
| çŠ¶æ€ç®¡ç† | æ–°å¢ 4 ç§å·¥ä½œçŠ¶æ€ä¸é¢œè‰²æŒ‡ç¤º |
| å®šæ—¶å™¨ | æ–°å¢æ´»åŠ¨æ£€æŸ¥å®šæ—¶å™¨ |

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºæµ®çƒ
```python
from ui.component.float_ball import FatigueReminderBall

ball = FatigueReminderBall()
ball.show()
```

### 2. ç›‘å¬æ´»åŠ¨
```python
# é”®ç›˜è¾“å…¥æ—¶
ball.mark_activity("keypress")

# é¼ æ ‡ç‚¹å‡»æ—¶
ball.mark_activity("click")
```

### 3. å¤„ç†æé†’
```python
ball.fatigue_reminder_triggered.connect(show_reminder_dialog)
```

### 4. æŸ¥è¯¢å·¥ä½œæ—¶é•¿
```python
duration_seconds = ball.get_work_duration()
duration_str = ball.get_work_duration_formatted()  # "5å°æ—¶30åˆ†é’Ÿ"
```

## ğŸ¨ é¢œè‰²çŠ¶æ€æ˜ å°„

| é¢œè‰² | å·¥ä½œæ—¶é•¿ | çŠ¶æ€ |
|------|--------|------|
| ğŸ”µ è“ | æ— æ´»åŠ¨ | IDLE (é—²ç½®) |
| ğŸŸ¢ ç»¿ | <22åˆ†é’Ÿ | WORKING (å·¥ä½œ) |
| ğŸŸ  æ©™ | 22-35åˆ†é’Ÿ | FATIGUED (ç–²æƒ«) |
| ğŸ”´ çº¢ | 35-50åˆ†é’Ÿ+ | EXHAUSTED (æåº¦) |

## â±ï¸ æ—¶é—´å‚æ•°ï¼ˆå¯é…ç½®ï¼‰

```python
ball.fatigue_threshold = 5 * 3600    # 5å°æ—¶åè§¦å‘ç–²æƒ«æé†’
ball.reminder_interval = 1800        # æ¯30åˆ†é’Ÿæé†’ä¸€æ¬¡
ball.idle_threshold = 300            # 5åˆ†é’Ÿæ— æ´»åŠ¨åˆ¤å®šä¸ºæš‚åœ
```

## ğŸ“¡ æ ¸å¿ƒæ–¹æ³•

```python
mark_activity(type)              # è®°å½•ç”¨æˆ·æ´»åŠ¨
get_work_duration()              # è¿”å›å·¥ä½œæ—¶é•¿(ç§’)
get_work_duration_formatted()    # è¿”å›æ ¼å¼åŒ–æ—¶é•¿
check_fatigue_reminder()         # æ£€æŸ¥æ˜¯å¦éœ€è¦æé†’
reset_work_session()             # é‡ç½®å·¥ä½œè®¡æ—¶
```

## ğŸ”” ä¿¡å·åˆ—è¡¨

| ä¿¡å· | è§¦å‘æ¡ä»¶ |
|------|--------|
| `fatigue_reminder_triggered` | å·¥ä½œ5å°æ—¶åï¼Œæ¯30åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ |
| `touched` | ç”¨æˆ·ç‚¹å‡»æµ®çƒ |
| `entered` | é¼ æ ‡è¿›å…¥æµ®çƒåŒºåŸŸ |
| `left` | é¼ æ ‡ç¦»å¼€æµ®çƒåŒºåŸŸ |
| `positionChanged` | æµ®çƒè¢«æ‹–åŠ¨ |

## ğŸ“¦ é›†æˆå»ºè®®

1. **åœ¨ä¸»åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºæµ®çƒ**
2. **å…¨å±€ç›‘å¬é”®ç›˜/é¼ æ ‡äº‹ä»¶ï¼Œè°ƒç”¨ `mark_activity()`**
3. **è¿æ¥ `fatigue_reminder_triggered` åˆ°æé†’å¯¹è¯æ¡†**
4. **å®šæœŸè¯»å–å·¥ä½œæ—¶é•¿ç”¨äºæ—¥å¿—/æŠ¥å‘Š**
5. **åº”ç”¨å…³é—­æ—¶è°ƒç”¨ `reset_work_session()`**

## ğŸ”„ å·¥ä½œæµç¨‹

```
ç”¨æˆ·æ´»åŠ¨ â†’ mark_activity() â†’ å¯åŠ¨/æ¢å¤å·¥ä½œä¼šè¯
           â†“
     æ£€æŸ¥é—²ç½®(æ¯ç§’)
           â†“
    æ— æ´»åŠ¨5åˆ†é’Ÿ â†’ æš‚åœå·¥ä½œä¼šè¯
           â†“
     å·¥ä½œ5å°æ—¶? 
         yes â†’ å‘é€ fatigue_reminder_triggered ä¿¡å·
         no â†’ ç»§ç»­è®°å½•
```

## ğŸ’¡ ä½¿ç”¨å»ºè®®

- **å®æ—¶äº¤äº’**: ä½¿ç”¨äº‹ä»¶è¿‡æ»¤å™¨åœ¨å…¨å±€èŒƒå›´å†…ç›‘å¬æ´»åŠ¨
- **æ•°æ®ä¿å­˜**: å®šæœŸä¿å­˜ `get_work_duration()` ç»“æœ
- **å¤šå±æ”¯æŒ**: æµ®çƒé»˜è®¤æ˜¾ç¤ºåœ¨ä¸»å±å¹•å³ä¸‹è§’
- **è‡ªå®šä¹‰æ ·å¼**: ä¿®æ”¹ `colors` å­—å…¸æ¥æ”¹å˜é¢œè‰²æ–¹æ¡ˆ
- **æµ‹è¯•**: ä½¿ç”¨ `fatigue_threshold = 60` (1åˆ†é’Ÿ) å¿«é€Ÿæµ‹è¯•

## âš ï¸ æ³¨æ„äº‹é¡¹

- æµ®çƒä½¿ç”¨ **æœ¬åœ° Unix æ—¶é—´æˆ³**ï¼Œç¡®ä¿ç³»ç»Ÿæ—¶é—´å‡†ç¡®
- **5åˆ†é’Ÿé—²ç½®** åˆ¤å®šä¸ºå·¥ä½œæš‚åœï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´ `idle_threshold`
- æé†’ **æ¯30åˆ†é’Ÿè§¦å‘ä¸€æ¬¡**ï¼Œå¯è°ƒæ•´ `reminder_interval`
- æµ®çƒä½ç½®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œåº”ç”¨å…³é—­åä¸ä¼šæŒä¹…åŒ–

## ğŸ“„ ç›¸å…³æ–‡ä»¶

- `float_ball.py` - ä¸»æ¨¡å—æ–‡ä»¶
- `FATIGUE_REMINDER_BALL_USAGE.md` - è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
- `fatigue_reminder_ball_integration.py` - é›†æˆç¤ºä¾‹ä»£ç 
